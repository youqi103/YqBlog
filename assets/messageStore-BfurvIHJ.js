import{q as n}from"./index-nN15iwqy.js";const g=n("message",{state:()=>({allMessages:[],defaultUser:{username:"访客",avatar:"@/statics/images/avatar.jpg"},defaultArticleId:1}),actions:{initAllMessages(){try{const t=localStorage.getItem("messageList");if(t){const e=JSON.parse(t);this.allMessages=e.map(s=>({...s,isLiked:s.isLiked??!1,isCollected:s.isCollected??!1,articleId:s.articleId??this.defaultArticleId}))}else this.allMessages=[{articleId:this.defaultArticleId,id:1,username:"忧戚",avatar:"@/statics/images/avatar.jpg",content:"欢迎大家在此留言......",time:"2025-12-5 10:12:50",commentCount:0,likeCount:0,collectCount:0,isLiked:!1,isCollected:!1}],this.saveToLocalStorage()}catch(t){console.error("加载留言列表失败:",t),this.allMessages=[{articleId:this.defaultArticleId,id:1,username:"忧戚",avatar:"@/statics/images/avatar.jpg",content:"欢迎大家在此留言......",time:"2025-12-5 10:12:50",commentCount:0,likeCount:0,collectCount:0,isLiked:!1,isCollected:!1}]}},addMessage(t,e,s,l){const i=t.trim();if(!i)throw new Error("留言内容不能为空！");if(!e||typeof e!="number")throw new Error("文章ID必须为有效数字！");const r=()=>{const a=new Date;return`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(a.getDate()).padStart(2,"0")} ${String(a.getHours()).padStart(2,"0")}:${String(a.getMinutes()).padStart(2,"0")}:${String(a.getSeconds()).padStart(2,"0")}`},o={articleId:e,id:Date.now(),username:s||this.defaultUser.username,avatar:l||this.defaultUser.avatar,content:i,time:r(),commentCount:0,likeCount:0,collectCount:0,isLiked:!1,isCollected:!1};return this.allMessages.unshift(o),this.saveToLocalStorage(),o},updateCommentCount(t,e=!0){const s=this.allMessages.find(l=>l.id===t);s&&(e?s.commentCount+=1:s.commentCount>0&&(s.commentCount-=1),this.saveToLocalStorage())},toggleLike(t){const e=this.allMessages.find(s=>s.id===t);e&&(e.likeCount=e.isLiked?e.likeCount-1:e.likeCount+1,e.isLiked=!e.isLiked,this.saveToLocalStorage())},toggleCollect(t){const e=this.allMessages.find(s=>s.id===t);e&&(e.collectCount=e.isCollected?e.collectCount-1:e.collectCount+1,e.isCollected=!e.isCollected,this.saveToLocalStorage())},deleteMessage(t){const e=this.allMessages.findIndex(s=>s.id===t);e!==-1&&(this.allMessages.splice(e,1),this.saveToLocalStorage())},deleteAllMessagesByArticleId(t){this.allMessages=this.allMessages.filter(e=>e.articleId!==t),this.saveToLocalStorage()},saveToLocalStorage(){try{localStorage.setItem("messageList",JSON.stringify(this.allMessages))}catch(t){console.error("保存留言列表失败:",t)}}},getters:{totalMessageCount:t=>t.allMessages.length,getMessagesByArticleId:t=>e=>t.allMessages.filter(s=>s.articleId===e),getMessageCountByArticleId:t=>e=>t.allMessages.filter(s=>s.articleId===e).length,getCollectedMessagesByArticleId:t=>e=>t.allMessages.filter(s=>s.articleId===e&&s.isCollected),getMessageById:t=>e=>t.allMessages.find(s=>s.id===e)}});export{g as u};
